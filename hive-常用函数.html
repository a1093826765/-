<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.4.8 (461813)"/><meta name="keywords" content="bigdata, hive, linux"/><meta name="altitude" content="38.998779296875"/><meta name="author" content="November"/><meta name="created" content="2020-09-15 15:58:53 +0000"/><meta name="latitude" content="22.97332946268708"/><meta name="longitude" content="113.7487264448071"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2020-09-19 01:27:08 +0000"/><title>hive-常用函数</title></head><body><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 441px;"/><col style="width: 439px;"/></colgroup><tbody><tr><td colspan="2" style="vertical-align: middle; background-color: rgb(0, 168, 45); border: 1px solid rgb(0, 134, 36); width: 880px; padding: 8px;"><div style="text-align: center; "><span style="font-size: 24px; --inversion-type-color:  simple;"><span style="font-size: 24px; --inversion-type-color:  simple; color: rgb(255, 255, 255); font-weight: bold;">hive-常用函数</span></span></div></td></tr><tr><td style="background-color: rgb(234, 234, 234); border: 1px solid rgb(187, 187, 187); width: 441px; padding: 8px;"><div>线索Cues</div></td><td style="background-color: rgb(234, 234, 234); border: 1px solid rgb(187, 187, 187); width: 439px; padding: 8px;"><div>笔记Notes</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 441px; padding: 8px;"><ol><li><div>查看当前库所有函数</div></li><li><div>查看某函数的使用</div></li><li><div>日期函数</div></li><li><div>常用取整函数</div></li><li><div>常用字符串操作函数</div></li><li><div>集合操作</div></li><li><div>常用函数</div></li><li><div>判断函数</div></li><li><div>窗口函数</div></li></ol></td><td style="border: 1px solid rgb(204, 204, 204); width: 439px; padding: 8px;"><ol><li><div><span style="caret-color: rgb(255, 147, 147); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Show functions; </span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Desc function 函数名;</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Desc function extended 函数名；</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">(查看详细解释) </span></div></li></ol><li><div><span style="caret-color: rgb(255, 147, 147); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">日期函数（</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">hive默认解析的日期必须是： yyyy-MM-dd HH:mm:ss</span><span style="caret-color: rgb(255, 147, 147); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">）</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">unix_timestamp:返回当前或指定时间的时间戳 </span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">—</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> select unix_timestamp(时间，传入时间格式</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">);</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">（如果不传参数，则获取当前时间）</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">from_unixtime：将时间戳转为日期格式</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select from_unixtime(时间戳，转出时间格式); </span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">current_date：当前日期</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select current_date(); </span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">current_timestamp：当前的日期加时间</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> current_timestamp();</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">to_date：抽取日期部分</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> to_date(时间日期)</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">year：获取年</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">month：获取月</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">day：获取日</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">hour：获取时</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">minute：获取分</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">second：获取秒</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">weekofyear：当前时间是一年中的第几周</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">dayofmonth：当前时间是一个月中的第几天</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">months_between： 两个日期间的月份，前-后</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select months_between(时间日期，时间日期); </span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">add_months：日期加减月</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select add_months(时间日期,加减多少个月)</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">datediff：两个日期相差的天数，前-后</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">datediff</span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">(时间日期，时间日期)</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">date_add：日期加天数</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> data_add(时间日期，加减多少天)</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">date_sub：日期减天数</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> data_sub(时间日期</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">，加减多少天</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">)</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">last_day：日期的当月的最后一天</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> last_day(时间日期)</span></div></li></ol><li><div><span style="font-size: unset; background-color: rgb(204, 204, 204); --inversion-type-background-color:  simple; --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">date_format格式化日期   date_format( 2019-11-24 08:09:10,'yyyy-MM')</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> 取整函数：</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">round： 四舍五入</span></div></li><li><div><span style="font-size: unset; background-color: rgb(204, 204, 204); --inversion-type-background-color:  simple; --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">ceil：  向上取整</span></div></li><li><div><span style="font-size: unset; background-color: rgb(204, 204, 204); --inversion-type-background-color:  simple; --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">floor： 向下取整</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">常用字符串操作:</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">upper： 转大写</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">lower： 转小写</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">length： 长度</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">trim：  前后去空格</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">lpad： 向左补齐，到指定长度</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">rpad：  向右补齐，到指定长度</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">regexp_replace：替换</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> SELECT regexp_replace('100-200', '(\d+)', 'num')</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">（替换后是</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">num-num，</span><span style="font-size: unset; background-color: rgb(204, 204, 204); --inversion-type-background-color:  simple; --inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">使用正则表达式匹配目标字符串，匹配成功后替换！）</span></div></li><li><div><span style="caret-color: rgb(255, 147, 147); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> regex_replace(‘100-200’,’1’,’a’)</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">（</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">替换后是</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">a00-200</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">）</span></div></li></ol></ol><li><div>集合操作:</div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">size： 集合（map和list）中元素的个数</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">map_keys： 返回map中的key</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">map_values: 返回map中的value</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">array_contains: 判断array中是否包含某个元素</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select array_contains(元素，集合) </span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">sort_array： 将array中的元素排序</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Select</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">sort_array(集合)</span></div></li></ol></ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">常用函数：</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">判断string1是否为null，如果为null,使用replace_with：</span><span style="--inversion-type-color: simple; color: rgb(0, 253, 255); font-family: &quot;Courier New&quot;;">nvl(string, replace_with)</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">(将null替换默认值，运行avg()时)</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">字符串拼接：</span><span style="--inversion-type-color: simple; color: rgb(0, 253, 255); font-family: &quot;Courier New&quot;;">concat(‘a’,’b’,...)</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">（当字符串中存在一个NULL,则返回NULL）</span></div></li><li><div><span style="--inversion-type-color:  simple; caret-color: rgb(255, 147, 147); color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">使用指定分隔符字符串和数组拼接：</span><span style="caret-color: rgb(255, 147, 147);"><span style="--inversion-type-color: simple; color: rgb(0, 253, 255); font-family: &quot;Courier New&quot;;">concat_ws(分隔符,字符串或字符串数组,…)</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">（返回拼接结果，会以分隔符分隔）</span></span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">将分组数据转化成数组：</span></div></li><ol><li><div><span style="caret-color: rgb(255, 147, 147); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">去重：collect_set(分组数据)</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">不去重：collect_list(分组数据)</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">将array转为多行数据，也可以把map转成多行多列</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255);"><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Explode(map或array)</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">(在使用时，不能有其它字段，只能sleect Explode() from table)</span></span></div></li></ol><li><div><span style="caret-color: rgb(255, 147, 147);"><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">侧写：lateral view</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0); font-family: &quot;Courier New&quot;;">(将同一行explode出来的数据示为一行)</span></span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">Lateral</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;"> view explode() 自定义表名 as 自定义列名</span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0); font-family: &quot;Courier New&quot;;">使用方式：select from 表名 lateral view explode() </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">自定义表名 as 自定义列名</span></div></li></ol></ol><li><div>判断语句：</div></li><ol><li><div>Case 列名 when 值 then 返回值 when 值2 then 返回值2 … else 返回值3 end<span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);"> (当列名的值为when值时，就返回then的返回值，当都不符合时，返回else的返回值)</span></div></li><li><div><span style="caret-color: rgb(255, 147, 147); --inversion-type-color:  simple; color: rgb(0, 0, 0);">If(判断语句，true返回值，false返回值)</span></div></li></ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">窗口函数：</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">语句：over( partition by 字段名 / order by 字段名 / window_clause)</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Window_clause — 指定窗口大小：</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">Over</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">(rows/range between 起始范围  preceding and 结束范围);</span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">（如果什么都不填，默认都是无限制）</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">起始范围：</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Unbounded — 无限制</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Num — 当前行的前num行开始</span></div></li></ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">结束范围：</span></div></li><ol><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Num  preceding — num行之前结束</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">current row</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);"> — 当前行结束</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Unbounded following — 无限制</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Num following —  num行之后结束</span></div></li></ol></ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">常用窗口：</span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">无限制到无限制：r</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">ows between </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Unbounded</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">  preceding and </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Unbounded following</span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">无限制到当前行：</span><span style="--inversion-type-color:  simple; caret-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">r</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">ows between </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">Unbounded</span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">  preceding and </span><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">current row</span></div></li></ol></ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">partition by — 可以完成分组功能，等同group by</span></div></li></ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">over之前需要函数支撑，仅支持以下函数：</span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">（lead,lag,rank,row_number,dense_rank,cume_dist,percent_rank,ntile等 over不支持自定义窗口）</span></span></div></li><ol><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">Lead — lead(列名,n行,默认值)； </span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">返回当前行下n行指定列，如果没有就返回默认值</span></span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">Lag — lag(列名,n行,默认值)；</span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);"> 返回当前行上n行指定列，如果没有返回默认值</span></span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">First_value — (列名,是否跳过NUll)；</span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">返回当前窗口指定列第一个值</span></span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">Last_value</span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);"> — (列名,是否跳过NUll)；</span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">返回当前窗口指定列最后一个值</span></span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">min — min(列名)； </span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">最小值</span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">max — max(列名)； </span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">最大值</span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">Avg — avg(列名)； </span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">平均值</span></span></div></li><li><div><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple; color: rgb(0, 0, 0);">Sum — sum(列名)； </span><span style="caret-color: rgb(255, 255, 255); --inversion-type-color:  simple;"><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">总数</span></span></div></li><li><div><span style="--inversion-type-color:  simple; color: rgb(0, 0, 0);">count — count(*)； </span><span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">总行</span></div></li><li><div>RANK — rank()； <span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">排名函数，允许并列排名，会跳号</span></div></li><li><div>ROW_NUMBER —<span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);"> row_number()；排名函数，不允许并列排名,也叫行号</span></div></li><li><div>DENSE_RANK — dense_rank()；<span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">排名函数，允许并列排名，不会跳号</span></div></li><li><div>CUME_DIST — cume_dist()； <span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">从排序后的第一行数据到当前行的数据个数，占整数据集的百分比</span></div></li><li><div>PERCENT_RANK — percent_rank() ； <span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);">rank-1/总数-1</span></div></li><li><div>NTILE — Ntile(x)；<span style="--inversion-type-color:  simple; color: rgb(108, 0, 0);"> 平均分到x个组中，返回记录所在的组号</span></div></li></ol></ol></ol></td></tr><tr><td colspan="2" style="background-color: rgb(234, 234, 234); border: 1px solid rgb(187, 187, 187); width: 880px; padding: 8px;"><div>:()总结Summary</div></td></tr><tr><td colspan="2" style="border: 1px solid rgb(204, 204, 204); width: 880px; padding: 8px;"><ul><li><div>记录最重要几点</div></li><li><div>写成可以快速检索形式</div></li><li><div>课后复习总结</div></li></ul><div><br/></div></td></tr></tbody></table><div><br/></div></body></html>